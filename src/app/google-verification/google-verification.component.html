<div class="main">
  <div class="login-wrap">
    <div class="bv"></div>
    <form style="width: 90%;" [formGroup]="otpForm" (ngSubmit)="submit()" autocomplete="off">
      <dl>
        <dt>Google Verification</dt>
        <dd>
          <label class="loginLable">OTP</label>
          <div class="otp-inputs" formArrayName="otp">
            <input type="text" maxlength="1" *ngFor="let ctrl of otpArray.controls; let i = index" [formControlName]="i"
              (input)="moveNext($event, i)" (keydown.backspace)="movePrev($event, i)"
              [appPatternRestrict]="pattern.mobile" />
          </div>
          <div class="error" *ngIf="otpForm.invalid && otpForm.touched">
            <small>Otp is required</small>
          </div>
        </dd>
        <dd class="first_heading">To complete your login, you‚Äôll need a 6-digit verification code from the Google
          Authenticator app.</dd>
        <dd *ngIf="!hasSetup">If this is your first time using it, follow the step-by-step guide after clicking the ‚ÄúSetup Google
          Auth‚Äù button.</dd>
        <dd class="logindd">
          <button id="loginBtn" type="submit" class="btn-send"> Login </button>
        </dd>
        <dd class="logindd" *ngIf="!hasSetup">
          <button type="button" class="btn-send" (click)="openGoogleSetup()"> Setup
            Google Auth </button>
        </dd>
      </dl>
    </form>
  </div>
</div>

<div *ngIf="showGoogleModal">
  <div class="modal-content">
    <div class="auth-setup-container">
      <div class="dialog-header">
        <h2>{{ 'üîê Set Up Google Authenticator' }}</h2>
        <i data-dismiss="modal" #googleInfoModel aria-label="Close" class="fa-solid fa-square-xmark cross"></i>
      </div>

      <ol class="auth-steps">
        <li>
          <strong>Install Google Authenticator App</strong>
          <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2"
            target="_blank">Android (Google Play Store)</a><br>
          <a href="https://apps.apple.com/app/google-authenticator/id388497605" target="_blank">iOS (App Store)</a>
        </li>

        <li>
          <strong>If You Have Multiple Google Accounts:</strong>
          Tap your <b>profile icon</b> in the Google Authenticator app<br />
          Select the <b>desired Google account</b> to link with the setup
        </li>

        <li>
          <strong>Add a New Account</strong> Tap the ‚Äú+‚Äù button ‚Üí Choose ‚ÄúScan QR code‚Äù
        </li>

        <li>
          <strong>Scan the QR Code</strong>
          <div class="qr-container">
            <p style="margin: 0;"><strong>{{ issuer }} - {{ email }}</strong></p>
            <img [src]="qrCode" alt="QR Code" class="qr-image">
          </div>
        </li>

        <li>
          <strong>Enter the 6-Digit Code</strong>
          Enter the code generated by the app to verify:
        </li>

        <li>
          <strong>Done!</strong>
          Your 2FA setup is complete. You‚Äôll need a new code every time you log in.
        </li>
      </ol>

      <div class="button_container">
        <button class="submit_btn submit_clr" mat-raised-button color="primary" type="button" (click)="showGoogleModal = false">
          Enter OTP
        </button>
      </div>
    </div>
  </div>
</div>